<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.olympic.game.GameMapper">
	<!-- #경기관련 -->
	<!-- 전체 리스트  -->
	<select id="listGame" parameterType="kr.co.olympic.game.GameVO">
        SELECT * FROM game
    </select>
	<!-- 경기 날짜별 리스트-->
	<select id="listBydate" parameterType="kr.co.olympic.game.GameVO">
        SELECT * FROM game
        WHERE korea_date = #{korea_date}
    </select>
	<!-- 경기 종목별 리스트-->
	<select id="listByGame" parameterType="kr.co.olympic.game.GameVO">
        SELECT * FROM game
        WHERE sport_name = #{sport_name}
    </select>
	<!-- 경기 생성 -->
	<insert id="createGame" parameterType="java.util.HashMap">
        INSERT INTO game (
            sport_name, country1_name, country2_name, tournament,
            country, country1_flag, country2_flag, stadium_name,
            paris_time, paris_date, korea_time, korea_date,
            sport_code, stadium_no
        ) VALUES (
            #{sport_name}, #{country1_name}, #{country2_name}, #{tournament},
            #{country}, #{country1_flag}, #{country2_flag}, #{stadium_name},
            #{paris_time}, #{paris_date}, #{korea_time}, #{korea_date},
            #{sport_code}, #{stadium_no}
        )
        <selectKey keyProperty="game_id" order="AFTER" resultType="int">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>
	<!-- 경기 수정 -->
	<update id="updateGame" parameterType="kr.co.olympic.game.GameVO">
        UPDATE game SET
            sport_name = #{sport_name},
            country1_name = #{country1_name},
            country2_name = #{country2_name},
            tournament = #{tournament},
            country = #{country},
            country1_flag = #{country1_flag},
            country2_flag = #{country2_flag},
            stadium_name = #{stadium_name},
            paris_time = #{paris_time},
            paris_date = #{paris_date},
            korea_time = #{korea_time},
            korea_date = #{korea_date},
            sport_code = #{sport_code},
            stadium_no = #{stadium_no}
        WHERE game_id = #{game_id}
    </update>
	<!-- 경기 삭제 -->
	<delete id="deleteGame" parameterType="kr.co.olympic.game.GameVO">
        DELETE FROM game WHERE game_id = #{game_id}
    </delete>
	<!-- 경기장 상세조회 -->
	<select id="detailGame" parameterType="int" resultType="kr.co.olympic.game.GameVO">
        SELECT * FROM game WHERE game_id = #{game_id}
    </select>
    
	<!-- #경기부가기능 -->
	<!-- 경기 댓글 생성 -->
	<insert id="createComment" parameterType="java.util.HashMap">
        INSERT INTO comment (regdate, content, game_id, member_no) 
        VALUES (#{regdate}, #{content}, #{game_id}, #{member_no})
        <selectKey keyProperty="game_id" order="AFTER" resultType="int">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>
	<!-- 경기 댓글 리스트 -->
	<select id="listComment" parameterType="kr.co.olympic.game.GameVO" resultType="kr.co.olympic.game.CommentVO">
        SELECT c.*
        FROM comment c
        INNER JOIN comment c 
        ON c.comment_no = c.comment_no
        WHERE gc.game_id = #{game_id}
    </select>
	<!-- 경기 관심 등록 -->
	<insert id="createFavorite" parameterType="java.util.HashMap">
        INSERT INTO favorite_game (member_no, game_id)
        VALUES (#{member_no}, #{game_id})
    </insert>
	
	<!-- 관심 경기 조회 -->
	<select id="listFavorite" parameterType="kr.co.olympic.member.MemberVO" 
		resultType="kr.co.olympic.game.GameVO">
        SELECT g.*
        FROM game g
        INNER JOIN favorite_game fg 
        ON g.game_id = fg.game_id
        WHERE fg.member_no = #{member_no}
    </select>
	
	<!-- 경기 관심 삭제 -->
	<delete id="deleteFavorite" parameterType="java.util.HashMap">
        DELETE FROM favorite_game
        WHERE member_no = #{member_no} AND game_id = #{game_id}
    </delete>
</mapper>